Serial version written with C
